# Analysis

```{r, echo=F, message=F}
source(here::here("scripts/setup.R"))
```

* Answers to the research questions

1) What does the text mining analysis of this book brings to light ?
a) general vocabulary analysis + chapter vocabulary analysis + part vocabulary analysis
b) overall token analysis + chapter token analysis + part token analysis
...

* Different methods considered

So far only **quanteda** package used, let's see if we can try with another one and explains differences and why we chose them.

* Competing approaches

Explain why we use the **quanteda** method (which is very similar to **tm**, explain how) rather than **tidytext** method 

* Justifications

## Sentiment Analysis

The sentiment analysis qualifies or quantifies the sentiment emerging from one text. To proceed to the sentiment analysis, we use two approaches. The first one uses qualifiers (i.e. dictionary-based) and the second one uses values (i.e. value-based). 

When analyzing the sentiment, we should not use the data in which stop words were removed since they might be in the sentiment dictionary used or created. 

```{r data.tk1, echo=F, message=F, warning=F}

# Not removing the stop words
data.tk3 <- data.tk1 %>%
            tokens_tolower() %>%
            tokens_replace(pattern = hash_lemmas$token, 
                              replacement = hash_lemmas$lemma)

```

### Dictionary-Based Sentiment Analysis

The dictionary-based sentiment analysis matches tokens from each document to a reference dictionary with token values and then look for word polarity. The sentiment is the average over token values of the document. 

The disadvantage of the dictionary-based sentiment analysis is that the negative forms are not taken into consideration. For example, in the sentence *I don't enjoy the show*, the sentence will be considered positive because it will not consider the contraction *don't* but only the word *enjoy*.

The following table shows the average sentiment over the token values of each chapter of the book. The possible sentiment can be **positive**, **negative**, **neg_positive** or **neg_negative**.

```{r dictionary-based analysis, echo=F, message=F, warning=F}

# Dictionary used
# data_dictionary_LSD2015 # un-comment to see the object

# Matches tokens with dictionary values
data.sent <- tokens_lookup(data.tk3, 
                           dictionary = data_dictionary_LSD2015) %>% 
             dfm() %>%                                                # creates a dtm matrix
             tidy()

kbl(data.sent, 
    caption = "Sentiment Analysis (Dictionary-Based)") %>% 
  kable_styling(bootstrap_options = c("striped", "hover"), 
                full_width = NULL)  

```

The graph is a graphical representation of the above table. For each chapter of the book, we see the proportion of each type of sentiments. 

```{r dictionary-based analysis plot, echo=F, message=F, warning=F}

# Plots the above tibble
ggplot(data.sent,
       aes(x = reorder(document, count), 
           y = count, 
           fill = term)) + 
  geom_bar(stat = "identity") + 
  coord_flip() + 
  labs(title = "Dictionary-Based Sentiment Analysis",
       x = "Count",
       y = "Chapter (i.e. document)")

```

### Valence Shifters 

The valence shifters approach uses positive/negative sentiment scores (i.e. value-based) to extract the sentiment of a document. 





